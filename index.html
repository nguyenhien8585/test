<!DOCTYPE html>
<html lang="vi">
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF to Text & Similar Problem Generator</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
  
  <style>
    :root {
      --ocean-primary: #0891b2;
      --ocean-secondary: #06b6d4;
      --ocean-dark: #0e7490;
      --ocean-light: #67e8f9;
      --ocean-lighter: #a5f3fc;
      --ocean-lightest: #cffafe;
      --ocean-bg: #ecfeff;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --info: #3b82f6;
      --text-primary: #0f172a;
      --text-secondary: #64748b;
      --border-light: #e0f2fe;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #cffafe 0%, #a5f3fc 25%, #67e8f9 50%, #22d3ee 75%, #0891b2 100%);
      min-height: 100vh;
      color: var(--text-primary);
      position: relative;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 20% 50%, rgba(8, 145, 178, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(103, 232, 249, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 40% 80%, rgba(34, 211, 238, 0.1) 0%, transparent 50%);
      animation: waveAnimation 15s ease-in-out infinite;
      z-index: -1;
    }

    @keyframes waveAnimation {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      25% { transform: translateY(-20px) rotate(1deg); }
      50% { transform: translateY(10px) rotate(-1deg); }
      75% { transform: translateY(-10px) rotate(0.5deg); }
    }

    .main-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
      animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Header Section */
    .header-section {
      background: linear-gradient(135deg, var(--ocean-primary) 0%, var(--ocean-secondary) 100%);
      color: white;
      padding: 40px;
      border-radius: 24px;
      margin-bottom: 30px;
      box-shadow: var(--shadow-xl);
      position: relative;
      overflow: hidden;
      text-align: center;
    }

    .header-section::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
      animation: shimmer 6s linear infinite;
    }

    @keyframes shimmer {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .title-main {
      font-size: 2.8rem;
      font-weight: 800;
      margin-bottom: 15px;
      text-shadow: 
        2px 2px 4px rgba(0,0,0,0.3),
        4px 4px 8px rgba(0,0,0,0.2);
      position: relative;
      z-index: 1;
      animation: titleFloat 6s ease-in-out infinite;
    }

    @keyframes titleFloat {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    .subtitle {
      font-size: 1.2rem;
      opacity: 0.95;
      font-weight: 400;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
      position: relative;
      z-index: 1;
      margin-bottom: 25px;
    }

    .ocean-badge {
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      display: inline-block;
      margin-left: 10px;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.05); opacity: 0.8; }
    }

    /* Mode Toggle */
    .mode-toggle-container {
      position: relative;
      z-index: 1;
      margin-top: 20px;
    }
    
    .mode-toggle-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      margin-bottom: 15px;
    }
    
    .mode-label {
      color: rgba(255, 255, 255, 0.9);
      font-weight: 600;
      font-size: 1rem;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .mode-label i {
      font-size: 1.1rem;
    }
    
    .mode-toggle {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 30px;
      cursor: pointer;
    }
    
    .mode-toggle input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .toggle-slider {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.3);
      border: 2px solid rgba(255, 255, 255, 0.5);
      border-radius: 30px;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 
        inset 0 2px 4px rgba(0,0,0,0.2),
        0 2px 8px rgba(0,0,0,0.1);
    }
    
    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 22px;
      width: 22px;
      left: 2px;
      top: 2px;
      background: linear-gradient(135deg, #ffffff 0%, #f1f5f9 100%);
      border-radius: 50%;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 
        0 2px 6px rgba(0,0,0,0.2),
        0 1px 3px rgba(0,0,0,0.1);
    }
    
    .mode-toggle input:checked + .toggle-slider {
      background: rgba(103, 232, 249, 0.9);
      border-color: rgba(103, 232, 249, 1);
      box-shadow: 
        inset 0 2px 4px rgba(8, 145, 178, 0.3),
        0 0 15px rgba(103, 232, 249, 0.5);
    }
    
    .mode-toggle input:checked + .toggle-slider:before {
      transform: translateX(30px);
      background: linear-gradient(135deg, #ffffff 0%, #67e8f9 30%, #ffffff 100%);
      box-shadow: 
        0 2px 8px rgba(8, 145, 178, 0.4),
        0 1px 4px rgba(0,0,0,0.2);
    }
    
    .mode-description {
      background: rgba(255, 255, 255, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      padding: 12px 20px;
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.95);
      text-align: center;
      backdrop-filter: blur(10px);
      font-weight: 500;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
      max-width: 400px;
      margin: 0 auto;
    }
    
    .mode-description.latex-mode {
      background: rgba(103, 232, 249, 0.2);
      border-color: rgba(103, 232, 249, 0.5);
      color: #ffffff;
    }

    /* Cards */
    .card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      box-shadow: var(--shadow-lg);
      border: none;
      margin-bottom: 30px;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      border: 2px solid var(--border-light);
    }

    .card:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-xl);
    }

    .card-header {
      background: linear-gradient(135deg, var(--ocean-primary) 0%, var(--ocean-secondary) 100%);
      color: white;
      border-radius: 20px 20px 0 0 !important;
      padding: 25px 30px;
      font-weight: 600;
      font-size: 1.25rem;
      border: none;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      position: relative;
      overflow: hidden;
    }

    .card-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      animation: cardShimmer 3s infinite;
    }

    @keyframes cardShimmer {
      0% { left: -100%; }
      100% { left: 100%; }
    }

    .card-body {
      padding: 30px;
    }

    /* Upload Zone */
    .upload-zone {
      border: 3px dashed var(--ocean-light);
      border-radius: 20px;
      padding: 50px 30px;
      text-align: center;
      background: linear-gradient(135deg, var(--ocean-bg) 0%, rgba(255, 255, 255, 0.8) 100%);
      transition: all 0.3s ease;
      cursor: pointer;
      margin: 25px 0;
      position: relative;
    }

    .upload-zone:hover {
      border-color: var(--ocean-primary);
      background: linear-gradient(135deg, var(--ocean-lightest) 0%, rgba(255, 255, 255, 0.9) 100%);
      transform: scale(1.02);
    }

    .upload-zone.dragover {
      border-color: var(--success);
      background: linear-gradient(135deg, #d1fae5 0%, #ecfdf5 100%);
      transform: scale(1.05);
    }

    .upload-zone.has-files {
      border-color: var(--success);
      border-style: solid;
      background: linear-gradient(135deg, #d1fae5 0%, #ecfdf5 100%);
    }

    .upload-icon {
      font-size: 4rem;
      color: var(--ocean-primary);
      margin-bottom: 20px;
      transition: all 0.3s ease;
      filter: drop-shadow(2px 2px 4px rgba(8, 145, 178, 0.3));
    }

    .upload-zone:hover .upload-icon {
      transform: scale(1.1) rotateY(10deg);
      color: var(--ocean-secondary);
    }

    .upload-zone.has-files .upload-icon {
      color: var(--success);
      animation: checkmark 0.5s ease;
    }

    @keyframes checkmark {
      0% { transform: scale(0); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }

    .upload-text {
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 8px;
      color: var(--text-primary);
      text-shadow: 1px 1px 2px rgba(8, 145, 178, 0.1);
    }
    
    .upload-subtext {
      color: var(--text-secondary);
      font-size: 0.95rem;
      font-weight: 500;
    }

    /* Buttons */
    .btn-ocean {
      background: linear-gradient(135deg, var(--ocean-primary) 0%, var(--ocean-secondary) 100%);
      border: none;
      padding: 15px 35px;
      border-radius: 12px;
      font-weight: 700;
      color: white;
      font-size: 1.1rem;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
      box-shadow: 
        0 6px 20px rgba(8, 145, 178, 0.4),
        inset 0 1px 0 rgba(255,255,255,0.2);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      text-decoration: none;
      display: inline-block;
      position: relative;
      overflow: hidden;
    }

    .btn-ocean::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transition: all 0.6s ease;
      transform: translate(-50%, -50%);
    }

    .btn-ocean:hover::before {
      width: 300px;
      height: 300px;
    }

    .btn-ocean:hover {
      color: white;
      transform: translateY(-3px) scale(1.05);
      box-shadow: 
        0 10px 30px rgba(8, 145, 178, 0.6),
        inset 0 1px 0 rgba(255,255,255,0.3);
    }

    .btn-ocean:active {
      transform: translateY(-1px) scale(1.02);
    }

    .btn-ocean:disabled {
      background: var(--text-secondary);
      transform: none;
      box-shadow: none;
      cursor: not-allowed;
    }

    .btn-outline-ocean {
      border: 2px solid var(--ocean-primary);
      color: var(--ocean-primary);
      background: rgba(255, 255, 255, 0.9);
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: 600;
      transition: all 0.3s ease;
      margin-right: 10px;
      box-shadow: 0 4px 12px rgba(8, 145, 178, 0.2);
    }
    
    .btn-outline-ocean:hover {
      background: linear-gradient(135deg, var(--ocean-primary) 0%, var(--ocean-secondary) 100%);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(8, 145, 178, 0.4);
      text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
    }

    /* Similar Generator Button */
    .btn-similar-ocean {
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 50%, #e74c3c 100%);
      border: none;
      padding: 12px 25px;
      border-radius: 8px;
      font-weight: 600;
      color: white;
      font-size: 0.95rem;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
      box-shadow: 
        0 4px 15px rgba(231, 76, 60, 0.4),
        inset 0 1px 0 rgba(255,255,255,0.2);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      margin-left: 10px;
    }
    
    .btn-similar-ocean:hover {
      transform: translateY(-2px) scale(1.05);
      box-shadow: 
        0 8px 25px rgba(231, 76, 60, 0.6),
        inset 0 1px 0 rgba(255,255,255,0.3);
      color: white;
    }

    /* Output */
    .output-content {
      background: #f8fafc;
      border: 2px solid var(--ocean-light);
      border-radius: 8px;
      padding: 20px;
      font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
      font-size: 14px;
      line-height: 1.6;
      white-space: pre-wrap;
      word-wrap: break-word;
      max-height: 500px;
      overflow-y: auto;
      margin-bottom: 15px;
      width: 100%;
      box-sizing: border-box;
      resize: vertical;
      min-height: 300px;
    }

    /* Similar Comparison Styles */
    .similar-comparison-section {
      display: none;
      margin-top: 30px;
      background: rgba(255, 255, 255, 0.98);
      border-radius: 20px;
      box-shadow: var(--shadow-xl);
      border: 2px solid var(--ocean-light);
      overflow: hidden;
      backdrop-filter: blur(10px);
    }

    .similar-comparison-section.show {
      display: block;
      animation: comparisonSlideIn 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @keyframes comparisonSlideIn {
      from { 
        opacity: 0; 
        transform: translateY(50px) scale(0.95);
      }
      to { 
        opacity: 1; 
        transform: translateY(0) scale(1);
      }
    }

    .comparison-header {
      background: linear-gradient(135deg, #ff6b6b 0%, #e74c3c 50%, #c0392b 100%);
      color: white;
      padding: 25px 30px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .comparison-title {
      font-size: 1.8rem;
      font-weight: 800;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      position: relative;
      z-index: 1;
    }

    .comparison-subtitle {
      font-size: 1rem;
      opacity: 0.9;
      font-weight: 500;
      position: relative;
      z-index: 1;
    }

    .comparison-content {
      padding: 30px;
    }

    .comparison-columns {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      min-height: 400px;
    }

    .comparison-column {
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      border: 2px solid var(--ocean-light);
      border-radius: 12px;
      padding: 25px;
      position: relative;
      overflow: hidden;
    }

    .column-header {
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, var(--ocean-primary) 0%, var(--ocean-secondary) 100%);
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      margin: -25px -25px 20px -25px;
      font-weight: 700;
      font-size: 1.1rem;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
      position: relative;
      z-index: 1;
    }

    .column-content {
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 20px;
      font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
      font-size: 13px;
      line-height: 1.6;
      white-space: pre-wrap;
      word-wrap: break-word;
      max-height: 450px;
      overflow-y: auto;
      min-height: 300px;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
      position: relative;
    }

    /* Image Preview Container */
    .image-preview-container {
      display: none !important;
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
      border: 2px solid var(--ocean-light);
      border-radius: 16px;
      margin: 20px 0;
      overflow: hidden;
      box-shadow: 0 8px 25px rgba(8, 145, 178, 0.15);
      animation: previewSlideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .image-preview-container.show {
      display: block !important;
    }
    
    @keyframes previewSlideIn {
      from {
        opacity: 0;
        transform: translateY(-20px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }
    
    .preview-header {
      background: linear-gradient(135deg, var(--ocean-primary) 0%, var(--ocean-secondary) 100%);
      color: white;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-weight: 600;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
    }

    /* Paste Indicator */
    .paste-indicator {
      background: linear-gradient(135deg, var(--ocean-lightest) 0%, rgba(207, 250, 254, 0.7) 100%);
      border: 2px dashed var(--ocean-primary);
      border-radius: 12px;
      padding: 15px 20px;
      text-align: center;
      margin: 15px 0;
      color: var(--ocean-primary);
      font-weight: 600;
      font-size: 0.9rem;
      opacity: 0.8;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .paste-indicator:hover {
      opacity: 1;
      transform: scale(1.02);
      box-shadow: 0 4px 12px rgba(8, 145, 178, 0.2);
    }

    /* Progress */
    .progress-container {
      display: none;
      width: 100%;
      background: linear-gradient(90deg, #e5e7eb 0%, #f3f4f6 100%);
      border-radius: 8px;
      margin: 15px 0;
      overflow: hidden;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .progress-bar {
      width: 0%;
      height: 24px;
      background: linear-gradient(135deg, var(--ocean-primary) 0%, var(--ocean-secondary) 100%);
      text-align: center;
      line-height: 24px;
      color: white;
      font-size: 13px;
      font-weight: 700;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
      transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    /* File Info */
    .file-info {
      background: var(--ocean-bg);
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      display: none;
      border: 1px solid var(--ocean-light);
    }
    
    .file-info.show {
      display: block;
    }

    /* Status Messages */
    .status-message {
      padding: 18px 25px;
      border-radius: 12px;
      margin: 20px 0;
      font-weight: 600;
      display: none;
      border-left: 5px solid;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      backdrop-filter: blur(10px);
    }
    
    .status-message.show {
      display: block;
      animation: statusSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .status-message.success {
      background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
      color: #166534;
      border-color: var(--success);
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
    }
    
    .status-message.error {
      background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
      color: #991b1b;
      border-color: var(--danger);
      box-shadow: 0 4px 12px rgba(239, 68, 68, 0.2);
    }
    
    .status-message.warning {
      background: linear-gradient(135deg, #fefbeb 0%, #fef3c7 100%);
      color: #92400e;
      border-color: var(--warning);
      box-shadow: 0 4px 12px rgba(245, 158, 11, 0.2);
    }
    
    .status-message.info {
      background: linear-gradient(135deg, var(--ocean-lightest) 0%, var(--ocean-bg) 100%);
      color: var(--ocean-dark);
      border-color: var(--ocean-primary);
      box-shadow: 0 4px 12px rgba(8, 145, 178, 0.2);
    }

    /* Loading Overlay */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle, rgba(8, 145, 178, 0.9) 0%, rgba(0,0,0,0.8) 100%);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      flex-direction: column;
      color: white;
      backdrop-filter: blur(10px);
    }

    .loading-overlay.show {
      display: flex;
    }

    .loading-spinner {
      width: 80px;
      height: 80px;
      border: 6px solid rgba(255,255,255,0.2);
      border-top: 6px solid var(--ocean-light);
      border-right: 6px solid var(--ocean-secondary);
      border-radius: 50%;
      animation: spin3d 1.5s cubic-bezier(0.4, 0, 0.2, 1) infinite;
      margin-bottom: 25px;
      filter: drop-shadow(0 0 20px rgba(103, 232, 249, 0.5));
    }
    
    @keyframes spin3d {
      0% { 
        transform: rotate(0deg) scale(1);
        filter: drop-shadow(0 0 20px rgba(103, 232, 249, 0.5));
      }
      50% { 
        transform: rotate(180deg) scale(1.1);
        filter: drop-shadow(0 0 30px rgba(103, 232, 249, 0.8));
      }
      100% { 
        transform: rotate(360deg) scale(1);
        filter: drop-shadow(0 0 20px rgba(103, 232, 249, 0.5));
      }
    }

    .loading-text {
      font-size: 1.2rem;
      text-align: center;
      max-width: 400px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
      font-weight: 600;
    }

    /* Results */
    .result-section {
      display: none;
      margin-top: 20px;
    }
    
    .result-section.show {
      display: block;
      animation: resultSlideIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    @keyframes resultSlideIn {
      from { 
        opacity: 0; 
        transform: translateY(30px) scale(0.95);
      }
      to { 
        opacity: 1; 
        transform: translateY(0) scale(1);
      }
    }
    
    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 12px;
      border-bottom: 2px solid var(--ocean-light);
    }
    
    .result-title {
      background: linear-gradient(135deg, var(--ocean-primary) 0%, var(--ocean-secondary) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: 800;
      text-shadow: 2px 2px 4px rgba(8, 145, 178, 0.2);
      font-size: 1.4rem;
      margin: 0;
      position: relative;
    }
    
    .result-title::after {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 0;
      width: 50px;
      height: 3px;
      background: linear-gradient(135deg, var(--ocean-primary) 0%, var(--ocean-secondary) 100%);
      border-radius: 2px;
      box-shadow: 0 2px 4px rgba(8, 145, 178, 0.3);
    }
    
    .mode-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      background: linear-gradient(135deg, var(--ocean-lightest) 0%, rgba(207, 250, 254, 0.8) 100%);
      padding: 8px 15px;
      border-radius: 20px;
      border: 2px solid var(--ocean-light);
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--ocean-primary);
      box-shadow: 0 2px 8px rgba(8, 145, 178, 0.15);
      transition: all 0.3s ease;
    }
    
    .mode-indicator.latex-mode {
      background: linear-gradient(135deg, rgba(103, 232, 249, 0.2) 0%, rgba(6, 182, 212, 0.1) 100%);
      border-color: var(--ocean-secondary);
      color: var(--ocean-dark);
    }

    /* Comparison Statistics */
    .comparison-stats {
      background: var(--ocean-lightest);
      border: 1px solid var(--ocean-light);
      border-radius: 12px;
      padding: 20px;
      margin-top: 25px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }

    .stat-item {
      text-align: center;
      padding: 15px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(8, 145, 178, 0.1);
    }

    .stat-value {
      font-size: 1.5rem;
      font-weight: 800;
      color: var(--ocean-primary);
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 0.9rem;
      color: var(--text-secondary);
      font-weight: 600;
    }

    /* Scrollbar */
    .output-content::-webkit-scrollbar,
    .column-content::-webkit-scrollbar {
      width: 10px;
    }
    
    .output-content::-webkit-scrollbar-track,
    .column-content::-webkit-scrollbar-track {
      background: linear-gradient(180deg, #f1f5f9 0%, #e2e8f0 100%);
      border-radius: 5px;
    }
    
    .output-content::-webkit-scrollbar-thumb,
    .column-content::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, var(--ocean-primary) 0%, var(--ocean-secondary) 100%);
      border-radius: 5px;
      box-shadow: inset 0 0 5px rgba(0,0,0,0.2);
    }
    
    .output-content::-webkit-scrollbar-thumb:hover,
    .column-content::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, var(--ocean-dark) 0%, var(--ocean-primary) 100%);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .main-container {
        padding: 15px;
      }
      
      .title-main {
        font-size: 2.2rem;
      }
      
      .card-body {
        padding: 20px;
      }
      
      .upload-zone {
        padding: 30px 15px;
      }
      
      .output-content {
        font-size: 13px;
        padding: 15px;
        min-height: 250px;
      }
      
      .btn-ocean {
        padding: 12px 25px;
        font-size: 1rem;
      }
      
      .comparison-columns {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      
      .comparison-stats {
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
      }
      
      .column-content {
        font-size: 12px;
        max-height: 300px;
        min-height: 200px;
      }
    }

    /* Hidden inputs */
    .hidden-input {
      position: absolute;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }

    /* Enhanced animations */
    .card-header i {
      animation: iconFloat 3s ease-in-out infinite;
    }
    
    @keyframes iconFloat {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-5px) rotate(5deg); }
    }
    
    .upload-zone:hover .upload-icon {
      animation: iconPulse 1s ease-in-out infinite;
    }
    
    @keyframes iconPulse {
      0%, 100% { transform: scale(1.1) rotateY(10deg); }
      50% { transform: scale(1.2) rotateY(15deg); }
    }

    .card:hover .card-header {
      box-shadow: 
        inset 0 0 20px rgba(103, 232, 249, 0.3),
        0 0 20px rgba(8, 145, 178, 0.2);
    }

    .mode-label.active {
      color: #ffffff;
      text-shadow: 
        0 0 10px rgba(103, 232, 249, 0.8),
        1px 1px 2px rgba(0,0,0,0.3);
      transform: scale(1.05);
    }
    
    .mode-label.inactive {
      color: rgba(255, 255, 255, 0.6);
      transform: scale(0.95);
    }

    @keyframes statusSlideIn {
      from {
        opacity: 0;
        transform: translateX(-100px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
  </style>
</head>
<body>
  <div class="main-container">
    <!-- Header -->
    <div class="header-section">
      <h1 class="title-main">
        PDF to Text & Similar Problem Generator
        <span class="ocean-badge">Enhanced v8.1</span>
      </h1>
      <p class="subtitle">
        Chuy·ªÉn ƒë·ªïi PDF sang vƒÉn b·∫£n (Word format) v√† t·∫°o b√†i t·∫≠p t∆∞∆°ng t·ª±
      </p>
    </div>

    <!-- PDF Processing -->
    <div class="card">
      <div class="card-header">
        <i class="fas fa-file-pdf me-2"></i>
        Chuy·ªÉn ƒë·ªïi PDF sang vƒÉn b·∫£n
      </div>
      <div class="card-body">
        <div class="upload-zone" id="pdfUploadArea">
          <input type="file" class="hidden-input" id="pdfFileInput" accept=".pdf">
          <div class="upload-icon">
            <i class="fas fa-file-pdf"></i>
          </div>
          <div class="upload-text">K√©o th·∫£ file PDF v√†o ƒë√¢y ho·∫∑c click ƒë·ªÉ ch·ªçn</div>
          <div class="upload-subtext">H·ªó tr·ª£ PDF t·ªëi ƒëa 25 trang, 10MB - ƒê·ªãnh d·∫°ng Word v·ªõi c√¥ng th·ª©c trong $...$</div>
        </div>

        <div class="file-info" id="pdfFileInfo">
          <h6><i class="fas fa-info-circle me-2"></i>Th√¥ng tin file PDF:</h6>
          <div id="pdfFileDetails"></div>
        </div>
        
        <div class="progress-container" id="pdfProgressContainer">
          <div class="progress-bar" id="pdfProgressBar">0%</div>
        </div>

        <div class="text-center">
          <button class="btn btn-ocean" id="processPdfBtn" disabled>
            <i class="fas fa-cogs me-2"></i>
            Chuy·ªÉn ƒë·ªïi PDF sang vƒÉn b·∫£n
          </button>
        </div>

        <div class="result-section" id="pdfResult">
          <div class="result-header">
            <h5 class="result-title">
              <i class="fas fa-file-text me-2"></i>
              N·ªôi dung vƒÉn b·∫£n t·ª´ PDF
            </h5>
          </div>
          <textarea class="output-content" id="pdfTextOutput" rows="15" readonly></textarea>
          <div class="output-actions">
            <button class="btn btn-outline-ocean" onclick="copyToClipboard('pdfTextOutput')">
              <i class="fas fa-copy me-1"></i>
              Sao ch√©p
            </button>
            <button class="btn btn-outline-ocean" onclick="downloadText('pdfTextOutput', 'pdf_text')">
              <i class="fas fa-download me-1"></i>
              T·∫£i v·ªÅ .txt
            </button>
            <button class="btn btn-outline-ocean" onclick="clearResults('pdfResult')">
              <i class="fas fa-trash me-1"></i>
              X√≥a
            </button>
            <button class="btn btn-similar-ocean" onclick="generateSimilar('pdfTextOutput', 'pdf')">
              <i class="fas fa-magic me-2"></i>
              T·∫°o b√†i t∆∞∆°ng t·ª±
            </button>
          </div>
        </div>
      </div>
    </div>


    <!-- Similar Problem Comparison Section -->
    <div class="similar-comparison-section" id="similarComparison">
      <div class="comparison-header">
        <h2 class="comparison-title">
          <i class="fas fa-columns me-2"></i>
          So S√°nh B√†i G·ªëc v√† B√†i T∆∞∆°ng T·ª±
        </h2>
        <p class="comparison-subtitle">
          Ocean AI t·∫°o b√†i t∆∞∆°ng t·ª± t·ª± ƒë·ªông v·ªõi c√πng ƒë·ªãnh d·∫°ng v√† s·ªë l∆∞·ª£ng c√¢u h·ªèi
        </p>
      </div>
      
      <div class="comparison-content">
        <div class="comparison-columns">
          <!-- Original Content Column -->
          <div class="comparison-column">
            <div class="column-header">
              <i class="fas fa-file-alt me-2"></i>
              <span>B√†i G·ªëc</span>
            </div>
            <div class="column-content" id="originalContent">
              <!-- Original content will be inserted here -->
            </div>
          </div>
          
          <!-- Similar Content Column -->
          <div class="comparison-column">
            <div class="column-header">
              <i class="fas fa-sparkles me-2"></i>
              <span>B√†i T∆∞∆°ng T·ª± (Ocean AI)</span>
            </div>
            <div class="column-content" id="similarContent">
              <!-- Similar content will be inserted here -->
            </div>
          </div>
        </div>
        
        <!-- Comparison Statistics -->
        <div class="comparison-stats" id="comparisonStats">
          <div class="stat-item">
            <div class="stat-value" id="originalQuestionCount">0</div>
            <div class="stat-label">C√¢u h·ªèi g·ªëc</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="similarQuestionCount">0</div>
            <div class="stat-label">C√¢u h·ªèi t∆∞∆°ng t·ª±</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="generationModel">AI Generator</div>
            <div class="stat-label">M√¥ h√¨nh t·∫°o</div>
          </div>
        </div>
        
        <!-- Comparison Actions -->
        <div class="comparison-actions" style="text-align: center; margin-top: 25px; padding-top: 20px; border-top: 2px solid var(--ocean-light);">
          <button class="btn btn-outline-ocean" onclick="copyComparison('similar')">
            <i class="fas fa-copy me-1"></i>
            Sao ch√©p b√†i t∆∞∆°ng t·ª±
          </button>
          <button class="btn btn-outline-ocean" onclick="downloadComparison('similar')">
            <i class="fas fa-download me-1"></i>
            T·∫£i b√†i t∆∞∆°ng t·ª±
          </button>
          <button class="btn btn-outline-ocean" onclick="downloadComparison('both')">
            <i class="fas fa-file-archive me-1"></i>
            T·∫£i c·∫£ 2 b√†i
          </button>
          <button class="btn btn-outline-ocean" onclick="closeComparison()">
            <i class="fas fa-times me-1"></i>
            ƒê√≥ng so s√°nh
          </button>
        </div>
      </div>
    </div>

    <!-- Status Messages -->
    <div class="status-message" id="statusMessage"></div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
      <div class="loading-spinner"></div>
      <div class="loading-text" id="loadingText">Ocean AI ƒëang x·ª≠ l√Ω...</div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // ===== GLOBAL VARIABLES =====
    let isProcessing = false;
    let selectedPdfFile = null;
    let selectedImageFile = null;
    let lastGeneratedComparison = null;

    const PDF_CONSTANTS = {
      MAX_PAGES: 25,
      IMAGE_SCALE: 1.5,
      IMAGE_FORMAT: 'image/jpeg',
      IMAGE_QUALITY: 0.85
    };

    // ===== INITIALIZATION =====
    document.addEventListener('DOMContentLoaded', function() {
      if (typeof pdfjsLib === 'undefined') {
        console.error("PDF.js library not loaded");
        showStatus("‚ö†Ô∏è L·ªói: Th∆∞ vi·ªán PDF.js ch∆∞a ƒë∆∞·ª£c t·∫£i. Ch·ª©c nƒÉng PDF s·∫Ω kh√¥ng ho·∫°t ƒë·ªông.", "error");
        document.getElementById('pdfUploadArea').style.opacity = '0.5';
        document.getElementById('pdfUploadArea').style.pointerEvents = 'none';
      } else {
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';
      }
      
      initializeApp();
    });

    function initializeApp() {
      setupFileUploads();
      setupButtons();
      
      // Show welcome message about Ocean theme and features
      setTimeout(() => {
        showStatus('Ch√†o m·ª´ng ƒë·∫øn v·ªõi PDF to Text & Similar Problem Generator v8.1 - Word Mode!', 'info');
      }, 1000);
      
      console.log('PDF to Text & Similar Problem Generator initialized successfully');
      console.log('‚úÖ Word mode only - LaTeX removed');
      console.log('‚úÖ Separated API keys: OCR + SIMILAR');
      console.log('‚úÖ Enhanced multi-API key system ready');
      console.log('‚úÖ Smart rotation and performance tracking enabled');
      console.log('üíé Multi paid keys support enabled');
    }

    // ===== MODE - WORD ONLY =====
    function getCurrentMode() {
      return 'word'; // Always Word mode
    }


    // ===== FILE UPLOAD SETUP =====
    function setupFileUploads() {
      setupSingleFileUpload('pdfUploadArea', 'pdfFileInput', '.pdf', handlePdfSelect);
    }

    function setupSingleFileUpload(areaId, inputId, accept, handler) {
      const uploadArea = document.getElementById(areaId);
      const fileInput = document.getElementById(inputId);
      
      uploadArea.addEventListener('click', function(e) {
        if (e.target !== fileInput) {
          fileInput.click();
        }
      });
      
      fileInput.addEventListener('change', handler);
      
      uploadArea.addEventListener('dragover', handleDragOver);
      uploadArea.addEventListener('dragleave', handleDragLeave);
      uploadArea.addEventListener('drop', (e) => handleDrop(e, handler));
    }

    function handleDragOver(event) {
      event.preventDefault();
      event.currentTarget.classList.add('dragover');
    }

    function handleDragLeave(event) {
      event.currentTarget.classList.remove('dragover');
    }

    function handleDrop(event, handler) {
      event.preventDefault();
      event.currentTarget.classList.remove('dragover');
      
      const files = event.dataTransfer.files;
      if (files.length > 0) {
        const mockEvent = { target: { files: files } };
        handler(mockEvent);
      }
    }

    // ===== FILE HANDLERS =====
    function handlePdfSelect(event) {
      const file = event.target.files[0];
      if (!file) return;
      
      if (!file.type.includes('pdf')) {
        showStatus('‚ùå Vui l√≤ng ch·ªçn file PDF!', 'error');
        return;
      }
      
      if (file.size > 10 * 1024 * 1024) {
        showStatus('‚ùå File PDF qu√° l·ªõn! T·ªëi ƒëa 10MB.', 'error');
        return;
      }
      
      selectedPdfFile = file;
      showPdfInfo(file);
      showStatus('‚úÖ File PDF ƒë√£ ƒë∆∞·ª£c ch·ªçn. Ocean AI ƒëang ƒë·ªçc th√¥ng tin...', 'info');
    }

    async function showPdfInfo(file) {
      const pdfInfoDiv = document.getElementById('pdfFileInfo');
      const pdfDetailsDiv = document.getElementById('pdfFileDetails');
      const sizeInMB = (file.size / (1024 * 1024)).toFixed(2);

      pdfDetailsDiv.innerHTML = `
        <div class="row">
          <div class="col-md-6"><strong>üìÑ T√™n file:</strong> ${file.name}</div>
          <div class="col-md-6"><strong>üíæ K√≠ch th∆∞·ªõc:</strong> ${sizeInMB} MB</div>
          <div class="col-md-6" id="pdfPagesCell"><strong>üìñ S·ªë trang:</strong> Ocean AI ƒëang ƒë·ªçc...</div>
          <div class="col-md-6"><strong>üîß Lo·∫°i:</strong> PDF to Text (Ocean Enhanced v8.1)</div>
        </div>
      `;
      pdfInfoDiv.classList.add('show');

      if (typeof pdfjsLib === 'undefined') return;

      try {
        const arrayBuffer = await file.arrayBuffer();
        const pdfDocument = await pdfjsLib.getDocument({data: arrayBuffer}).promise;
        const numPages = pdfDocument.numPages;
        
        document.getElementById('pdfPagesCell').innerHTML = `<strong>üìñ S·ªë trang:</strong> ${numPages}`;
        
        if (numPages > PDF_CONSTANTS.MAX_PAGES) {
          showStatus(`‚ùå File PDF c√≥ ${numPages} trang, v∆∞·ª£t qu√° gi·ªõi h·∫°n ${PDF_CONSTANTS.MAX_PAGES} trang.`, 'error');
          document.getElementById('processPdfBtn').disabled = true;
        } else {
          document.getElementById('processPdfBtn').disabled = false;
          showStatus('‚úÖ Ocean AI ƒë√£ ƒë·ªçc th√¥ng tin PDF. S·∫µn s√†ng x·ª≠ l√Ω!', 'success');
        }
      } catch (error) {
        console.error("Error reading PDF:", error);
        document.getElementById('pdfPagesCell').innerHTML = '<strong>üìñ S·ªë trang:</strong> ‚ùå L·ªói ƒë·ªçc file';
        showStatus('‚ùå L·ªói ƒë·ªçc th√¥ng tin PDF: ' + error.message, 'error');
      }
    }

    // ===== BUTTON SETUP =====
    function setupButtons() {
      document.getElementById('processPdfBtn').addEventListener('click', processPdf);
    }

    // ===== PROCESSING FUNCTIONS =====
    async function processPdf() {
      if (isProcessing || !selectedPdfFile) return;
      
      if (typeof pdfjsLib === 'undefined') {
        showStatus('‚ùå L·ªói: Th∆∞ vi·ªán PDF.js ch∆∞a s·∫µn s√†ng.', 'error');
        return;
      }

      isProcessing = true;
      const progressContainer = document.getElementById('pdfProgressContainer');
      const progressBar = document.getElementById('pdfProgressBar');
      progressContainer.style.display = 'block';
      progressBar.style.width = '0%';
      progressBar.textContent = '0%';

      showLoading('üìÑ Ocean AI ƒëang chuy·ªÉn ƒë·ªïi PDF sang ·∫£nh...');
      hideResults();
      document.getElementById('processPdfBtn').disabled = true;

      try {
        const arrayBuffer = await selectedPdfFile.arrayBuffer();
        updateLoadingText('‚è≥ Ocean AI ƒëang t·∫£i PDF...');
        const pdfDocument = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
        
        const numPages = pdfDocument.numPages;
        if (numPages > PDF_CONSTANTS.MAX_PAGES) {
          throw new Error(`S·ªë trang (${numPages}) v∆∞·ª£t qu√° gi·ªõi h·∫°n ${PDF_CONSTANTS.MAX_PAGES} trang.`);
        }

        const arrayOfBase64Images = [];

        for (let i = 1; i <= numPages; i++) {
          updateLoadingText(`üé® Ocean AI ƒëang chuy·ªÉn trang ${i}/${numPages} sang ·∫£nh...`);
          const page = await pdfDocument.getPage(i);
          const viewport = page.getViewport({ scale: PDF_CONSTANTS.IMAGE_SCALE });
          
          const canvas = document.createElement('canvas');
          canvas.width = viewport.width;
          canvas.height = viewport.height;
          const context = canvas.getContext('2d');
          
          await page.render({ canvasContext: context, viewport: viewport }).promise;
          
          const base64Image = canvas.toDataURL(PDF_CONSTANTS.IMAGE_FORMAT, PDF_CONSTANTS.IMAGE_QUALITY).split(',')[1];
          arrayOfBase64Images.push(base64Image);
          
          const progress = Math.round((i / numPages) * 100);
          progressBar.style.width = progress + '%';
          progressBar.textContent = progress + '%';
        }

        updateLoadingText('ü§ñ Ocean AI ƒëang g·ª≠i l√™n server ƒë·ªÉ chuy·ªÉn ƒë·ªïi sang vƒÉn b·∫£n...');

        const currentMode = getCurrentMode();
        
        const result = await new Promise((resolve, reject) => {
          google.script.run
            .withSuccessHandler(resolve)
            .withFailureHandler(reject)
            .processPdfToText(arrayOfBase64Images, currentMode);
        });

        hideLoading();
        progressContainer.style.display = 'none';
        document.getElementById('processPdfBtn').disabled = false;
        isProcessing = false;

        if (result.success) {
          showResult('pdfResult', 'pdfTextOutput', result.result);
          const metadata = result.metadata || {};
          showStatus(`‚úÖ Chuy·ªÉn ƒë·ªïi PDF th√†nh c√¥ng! (${metadata.total_pages} trang)`, 'success');
        } else {
          showStatus('‚ùå L·ªói: ' + result.error, 'error');
        }

      } catch (error) {
        hideLoading();
        progressContainer.style.display = 'none';
        document.getElementById('processPdfBtn').disabled = false;
        isProcessing = false;
        showStatus('‚ùå L·ªói x·ª≠ l√Ω PDF: ' + error.message, 'error');
      }
    }


    // ===== SIMILAR PROBLEM GENERATION =====
    async function generateSimilar(outputElementId, sourceType) {
      if (isProcessing) {
        showStatus('‚ö†Ô∏è Ocean AI ƒëang x·ª≠ l√Ω, vui l√≤ng ƒë·ª£i...', 'warning');
        return;
      }
      
      const outputElement = document.getElementById(outputElementId);
      const originalContent = outputElement.value;
      
      if (!originalContent || originalContent.trim().length < 50) {
        showStatus('‚ùå N·ªôi dung qu√° ng·∫Øn ƒë·ªÉ t·∫°o b√†i t∆∞∆°ng t·ª±! C·∫ßn √≠t nh·∫•t 50 k√Ω t·ª±.', 'error');
        return;
      }
      
      isProcessing = true;
      showLoading('üéØ Ocean AI ƒëang ph√¢n t√≠ch b√†i g·ªëc v√† t·∫°o b√†i t∆∞∆°ng t·ª±...');
      
      try {
        const currentMode = getCurrentMode();
        updateLoadingText(`ü§ñ Ocean AI ƒëang t·∫°o b√†i t∆∞∆°ng t·ª± (${currentMode.toUpperCase()})...`);
        
        const result = await new Promise((resolve, reject) => {
          google.script.run
            .withSuccessHandler(resolve)
            .withFailureHandler(reject)
            .generateSimilarProblems(originalContent, currentMode, { singleShot: true });
        });
        
        hideLoading();
        isProcessing = false;
        
        if (result.success) {
          lastGeneratedComparison = result.result;
          showComparison(result.result);
          
          const comparison = result.result.comparison || {};
          showStatus(`‚úÖ Ocean AI ƒë√£ t·∫°o b√†i t∆∞∆°ng t·ª±! (${comparison.original_questions || 0} c√¢u ‚Üí ${comparison.similar_questions || 0} c√¢u)`, 'success');
        } else {
          showStatus('‚ùå L·ªói t·∫°o b√†i t∆∞∆°ng t·ª±: ' + result.error, 'error');
        }
        
      } catch (error) {
        hideLoading();
        isProcessing = false;
        showStatus('‚ùå L·ªói: ' + error.message, 'error');
      }
    }
    
    function showComparison(comparisonData) {
      const { original, similar, comparison } = comparisonData;
      
      document.getElementById('originalContent').textContent = original;
      document.getElementById('similarContent').textContent = similar;
      
      document.getElementById('originalQuestionCount').textContent = comparison.original_questions || 0;
      document.getElementById('similarQuestionCount').textContent = comparison.similar_questions || 0;
      document.getElementById('generationModel').textContent = 'AI Generator v8.1';
      
      document.getElementById('similarComparison').classList.add('show');
      
      setTimeout(() => {
        document.getElementById('similarComparison').scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      }, 300);
    }
    
    function closeComparison() {
      document.getElementById('similarComparison').classList.remove('show');
      lastGeneratedComparison = null;
      showStatus('üîí ƒê√£ ƒë√≥ng giao di·ªán so s√°nh', 'info');
    }
    
    function copyComparison(type) {
      if (!lastGeneratedComparison) {
        showStatus('‚ùå Kh√¥ng c√≥ d·ªØ li·ªáu so s√°nh ƒë·ªÉ sao ch√©p!', 'error');
        return;
      }
      
      let contentToCopy = '';
      
      if (type === 'similar') {
        contentToCopy = lastGeneratedComparison.similar;
      } else if (type === 'both') {
        contentToCopy = `B√ÄI G·ªêC:\n${lastGeneratedComparison.original}\n\n${'='.repeat(50)}\n\nB√ÄI T∆Ø∆†NG T·ª∞ (OCEAN AI):\n${lastGeneratedComparison.similar}`;
      }
      
      navigator.clipboard.writeText(contentToCopy).then(() => {
        const typeText = type === 'similar' ? 'b√†i t∆∞∆°ng t·ª±' : 'c·∫£ 2 b√†i';
        showStatus(`‚úÖ ƒê√£ sao ch√©p ${typeText} v√†o clipboard!`, 'success');
      }).catch(err => {
        showStatus('‚ùå L·ªói sao ch√©p: ' + err, 'error');
      });
    }
    
    function downloadComparison(type) {
      if (!lastGeneratedComparison) {
        showStatus('‚ùå Kh√¥ng c√≥ d·ªØ li·ªáu so s√°nh ƒë·ªÉ t·∫£i xu·ªëng!', 'error');
        return;
      }
      
      const timestamp = new Date().getTime();
      
      if (type === 'similar') {
        const blob = new Blob([lastGeneratedComparison.similar], { type: 'text/plain;charset=utf-8' });
        downloadBlob(blob, `similar_problems_${timestamp}.txt`);
        showStatus('‚úÖ ƒê√£ t·∫£i b√†i t∆∞∆°ng t·ª±!', 'success');
      } else if (type === 'both') {
        const combinedContent = `B√ÄI G·ªêC:\n${lastGeneratedComparison.original}\n\n${'='.repeat(50)}\n\nB√ÄI T∆Ø∆†NG T·ª∞:\n${lastGeneratedComparison.similar}`;
        const blob = new Blob([combinedContent], { type: 'text/plain;charset=utf-8' });
        downloadBlob(blob, `comparison_${timestamp}.txt`);
        showStatus('‚úÖ ƒê√£ t·∫£i c·∫£ 2 b√†i!', 'success');
      }
    }
    
    function downloadBlob(blob, filename) {
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      window.URL.revokeObjectURL(url);
      document.body.removeChild(a);
    }

    // ===== UTILITY FUNCTIONS =====
    function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result.split(',')[1]);
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }

    function showLoading(text) {
      document.getElementById('loadingText').innerHTML = text;
      document.getElementById('loadingOverlay').classList.add('show');
    }

    function updateLoadingText(text) {
      document.getElementById('loadingText').innerHTML = text;
    }

    function hideLoading() {
      document.getElementById('loadingOverlay').classList.remove('show');
    }

    function showResult(resultId, outputId, content) {
      document.getElementById(outputId).value = content;
      document.getElementById(resultId).classList.add('show');
    }

    function hideResults() {
      document.querySelectorAll('.result-section').forEach(result => {
        result.classList.remove('show');
      });
    }

    function showStatus(message, type = 'info') {
      const statusElement = document.getElementById('statusMessage');
      statusElement.innerHTML = message;
      statusElement.className = `status-message ${type} show`;
      
      setTimeout(() => {
        statusElement.classList.remove('show');
      }, 8000);
    }

    function copyToClipboard(elementId) {
      const element = document.getElementById(elementId);
      element.select();
      element.setSelectionRange(0, 99999);
      
      navigator.clipboard.writeText(element.value).then(() => {
        showStatus('‚úÖ ƒê√£ sao ch√©p v√†o clipboard!', 'success');
      }).catch(err => {
        showStatus('‚ùå L·ªói sao ch√©p: ' + err, 'error');
      });
    }

    function downloadText(elementId, prefix) {
      const content = document.getElementById(elementId).value;
      
      const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
      downloadBlob(blob, `${prefix}_${new Date().getTime()}.txt`);
      
      showStatus(`‚úÖ File ƒë√£ ƒë∆∞·ª£c t·∫£i xu·ªëng!`, 'success');
    }

    function clearResults(resultId) {
      document.getElementById(resultId).classList.remove('show');
      
      if (resultId === 'pdfResult') {
        document.getElementById('pdfTextOutput').value = '';
        selectedPdfFile = null;
        document.getElementById('pdfFileInfo').classList.remove('show');
        document.getElementById('processPdfBtn').disabled = true;
        document.getElementById('pdfFileInput').value = '';
      }
      
      showStatus('üóëÔ∏è ƒê√£ x√≥a k·∫øt qu·∫£', 'info');
    }

    // ===== GLOBAL FUNCTIONS =====
    window.copyToClipboard = copyToClipboard;
    window.downloadText = downloadText;
    window.clearResults = clearResults;
    window.getCurrentMode = getCurrentMode;
    window.generateSimilar = generateSimilar;
    window.copyComparison = copyComparison;
    window.downloadComparison = downloadComparison;
    window.closeComparison = closeComparison;

    // ===== CONSOLE LOGS =====
    console.log('PDF to Text & Similar Problem Generator v8.1 - Initialized');
    console.log('üé® Theme: Enhanced Ocean Blue with Wave Animation');
    console.log('‚ö° Features: 3D Effects, Smooth Animations, Responsive Layout');
    console.log('üìÑ Focus: PDF to Text only (Image processing removed)');
    console.log('üìù Mode: Word format only (formulas in $...$)');
    console.log('üéØ Similar: AI Similar Problem Generator');
    console.log('üîë API: Separated keys - OCR (10 keys) + SIMILAR (29 keys)');
    console.log('üìä Features: Question counting, format preservation, difficulty matching');
    console.log('üé≤ Creativity: AI generates similar problems while maintaining structure');
    console.log('üì± Mobile: Responsive design with improved touch interface');
    console.log('üíé Backend: Enhanced multi-key rotation for better reliability');
    console.log('‚úÖ Ready to process PDF documents in Word format!');
  </script>
</body>
</html>
